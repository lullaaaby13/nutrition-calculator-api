import{Q as J}from"./QSelect.8bcd1fcf.js";import{C as ue,D as $,d as Q,b as L,c as k,o as C,e as x,w as o,_ as I,aH as M,g as t,f as e,t as m,n as h,E as S,h as g,Q as Z,p as B,i as T,F as R,r as w,aI as O,G as K,H as W,k as j,l as G,m as F,a as ne,M as z,I as ee,j as te,J as le,L as ie}from"./index.d24fbe54.js";import{Q as ce,_ as X,a as y}from"./ingredient.ed0b9d9d.js";import{a as N,Q as de,b as Y}from"./route-block.50262eb6.js";import{R as re,l as me,r as V,i as E}from"./receipt.1056e981.js";import{Q as pe,_ as ae,a as se}from"./AmountUnitPriceCaption.7d375513.js";const H=ue("receiptPageStore",()=>{const b=$(!1),n=()=>{b.value=!0},f=()=>{b.value=!1},_=$({id:0,memo:"",name:"",sellingPrice:0,category:re.coffee,components:[],createdAt:"",updatedAt:""}),a=$(!1);return{createReceiptDialog:b,showCreateReceiptDialog:n,closeCreateReceiptDialog:f,updateReceipt:_,updateReceiptDialog:a,showUpdateReceiptDialog:p=>{_.value=p,a.value=!0},closeUpdateReceiptDialog:()=>{a.value=!1}}}),Ce={class:"text-h5"},_e={class:"flex q-gutter-x-md"},ve={class:"text-subtitle2"},ge={class:"text-subtitle2"},fe={class:"flex q-gutter-x-md"},he={class:"text-caption"},xe={class:"text-caption"},Be={class:"text-caption"},ye={class:"text-caption"},be={class:"text-caption"},De={class:"q-gutter-md"},ke={class:"row"},$e={key:0,class:"col-6"},Ae=e("div",{class:"text-subtitle2 q-mb-sm"},"\uBCA0\uC774\uC2A4",-1),Se={key:1,class:"col-6"},Ve=e("div",{class:"text-subtitle2 q-mb-sm"},"\uC6D0\uC7AC\uB8CC",-1),Ee=e("div",{class:"text-caption"},"\uBA54\uBAA8",-1),Re={style:{"min-height":"60px"}},we=Q({__name:"ReceiptCard",props:{id:{},name:{},memo:{},category:{},components:{},sellingPrice:{},createdAt:{},updatedAt:{}},setup(b){const n=b,f=H(),_=L(),a=k(()=>n.components.filter(r=>r.type==="SECRET_BASE")),u=k(()=>n.components.filter(r=>r.type==="INGREDIENT")),c=k(()=>{let r=new M;return r.addReceiptComponents(n.components),r}),p=k(()=>{let r=Number(n.sellingPrice);return!r||r===0?0:r*.1}),d=k(()=>{let r=Number(n.sellingPrice);return!r||r===0?0:r*.11}),D=k(()=>{let r=Number(n.sellingPrice);if(!r||r===0)return 0;const i=c.value.getUnitPrice();return(r-(Number(i)+p.value+d.value))/r}),A=async r=>{confirm("\uC815\uB9D0 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC5B4\uC694?")&&await _.remove(r)};return(r,i)=>(C(),x(I,{style:{width:"400px"}},{default:o(()=>[t(g,{class:"flex"},{default:o(()=>[e("div",null,[e("div",Ce,m(n.name),1),e("div",_e,[e("div",ve,m(h(me)(n.category)),1),e("span",ge,"\uC911\uB7C9: "+m(Number(c.value.getAmount()).toFixed(0))+"g",1)]),e("div",fe,[e("div",he,"\uD310\uB9E4\uAC00: "+m(Number(n.sellingPrice).toFixed(0))+"\uC6D0",1),e("div",xe,"\uB2E8\uAC00: "+m(Number(c.value.getUnitPrice()).toFixed(0))+"\uC6D0",1),e("div",Be,"\uBD80\uAC00\uC138: "+m(p.value)+"\uC6D0",1),e("div",ye,"\uCE74\uB4DC\uC218\uC218\uB8CC: "+m(d.value)+"\uC6D0",1),e("div",be,"\uB9C8\uC9C4\uC728: "+m((D.value*100).toFixed(2))+"%",1)])]),t(ce),e("div",De,[t(S,{dense:"",outline:"",color:"secondary",onClick:i[0]||(i[0]=l=>h(f).showUpdateReceiptDialog(n)),icon:"edit",flat:""}),t(S,{dense:"",outline:"",color:"red",icon:"delete",flat:"",onClick:i[1]||(i[1]=l=>A(n.id))})])]),_:1}),t(Z),t(g,null,{default:o(()=>[e("div",ke,[a.value.length>0?(C(),B("div",$e,[Ae,t(T,{bordered:""},{default:o(()=>[(C(!0),B(R,null,w(a.value,(l,s)=>(C(),x(j,{key:s},{default:o(()=>[t(G,null,{default:o(()=>[t(N,null,{default:o(()=>[F(m(l.amount),1)]),_:2},1024),t(N,{caption:"",lines:"1"},{default:o(()=>[F(m(l.secretBase.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):O("",!0),u.value.length>0?(C(),B("div",Se,[Ve,t(T,{bordered:""},{default:o(()=>[(C(!0),B(R,null,w(u.value,(l,s)=>(C(),x(j,{key:s},{default:o(()=>[t(G,null,{default:o(()=>[t(N,null,{default:o(()=>[F(m(l.amount),1)]),_:2},1024),t(N,{caption:"",lines:"1"},{default:o(()=>[F(m(l.ingredient.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):O("",!0)])]),_:1}),t(g,null,{default:o(()=>[t(X,K(W(c.value)),null,16)]),_:1}),t(g,null,{default:o(()=>[Ee,e("div",Re,m(n.memo),1)]),_:1})]),_:1}))}}),Pe={class:"q-px-md"},qe={class:"row justify-end q-mb-lg"},Ue={class:"col-3"},Ie=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"\uC6D0\uC7AC\uB8CC\uBA85"),e("th",{class:"text-center"},"\uCE7C\uB85C\uB9AC(Kcal)"),e("th",{class:"text-center"},"\uD0C4\uC218\uD654\uBB3C(g)"),e("th",{class:"text-center"},"\uB2E8\uBC31\uC9C8(g)"),e("th",{class:"text-center"},"\uC9C0\uBC29(g)"),e("th",{class:"text-center"},"\uD3EC\uD654\uC9C0\uBC29(g)"),e("th",{class:"text-center"},"\uB2F9\uB958(g)"),e("th",{class:"text-center"},"\uCE74\uD398\uC778(mg)"),e("th",{class:"text-center"},"\uC911\uB7C9(g)"),e("th",{class:"text-center"},"\uB2E8\uAC00(\uC6D0)")])],-1),Qe=["onClick"],Fe={class:"text-center"},Ne={class:"text-right"},Te={class:"text-right"},Oe={class:"text-right"},je={class:"text-right"},Ge={class:"text-right"},Le={class:"text-right"},Me={class:"text-right"},ze={class:"text-right"},He={class:"text-right"},Je={class:"text-right"},oe=Q({__name:"SecretBaseSearchTable",emits:["onSecretBaseClick"],setup(b){const n=ne(),f=_=>{const a=new M(_.id,_.name);return a.addSecretBaseComponents(_.components),a};return(_,a)=>(C(),B("div",Pe,[e("div",qe,[e("div",Ue,[t(y,{type:"text",label:"\uC2DC\uD06C\uB9BF\uBCA0\uC774\uC2A4 \uCC3E\uAE30","stack-label":""},{default:o(()=>[t(z,{name:"search",color:"secondary"})]),_:1})])]),t(pe,null,{default:o(()=>[Ie,e("tbody",null,[(C(!0),B(R,null,w(h(n).secretBases.map(u=>({secretBase:u,summary:f(u)})),({secretBase:u,summary:c},p)=>(C(),B("tr",{key:p,onClick:d=>_.$emit("onSecretBaseClick",u)},[e("td",Fe,m(c.getName()),1),e("td",Ne,m(c.getCalories()),1),e("td",Te,m(c.getCarbohydrates()),1),e("td",Oe,m(c.getSugar()),1),e("td",je,m(c.getFiber()),1),e("td",Ge,m(c.getFat()),1),e("td",Le,m(c.getSaturatedFat()),1),e("td",Me,m(c.getProtein()),1),e("td",ze,m(c.getCaffeine()),1),e("td",He,m(c.getAmount()),1),e("td",Je,m(c.getUnitPrice()),1)],8,Qe))),128))])]),_:1})]))}}),Ke=e("div",{class:"text-h6"},"\uB808\uC2DC\uD53C \uB4F1\uB85D",-1),We={class:"q-gutter-x-md"},Xe={class:"col-8 q-gutter-y-md"},Ye={class:"col-4 q-px-md"},Ze={class:"row"},et={class:"col-4 q-pr-md"},tt={class:"col-4 q-pr-md"},lt={class:"col-4"},at=e("div",{class:"text-subtitle2 q-mb-sm"}," \uC7AC\uB8CC ",-1),st=Q({__name:"CreateReceiptDialog",setup(b){const n=H(),f=L(),_=()=>({name:"",memo:"",category:V[0],sellingPrice:0}),a=$(_()),u=$([]),c=i=>{const l={type:"INGREDIENT",amount:10,ingredient:i};u.value.some(v=>E(v,l))||u.value.push(l)},p=i=>{const l={type:"SECRET_BASE",amount:10,secretBase:i};u.value.some(v=>E(v,l))||u.value.push(l)},d=i=>{const l=u.value.findIndex(s=>E(s,i));l!==-1&&u.value.splice(l,1)},D=k(()=>{const i=new M;return i.addReceiptComponents(u.value),i}),A=async()=>{const i={name:a.value.name,memo:a.value.memo,category:a.value.category.value,sellingPrice:a.value.sellingPrice,components:u.value.map(l=>{var s,v;return{type:l.type,amount:l.amount,id:((s=l.secretBase)==null?void 0:s.id)||((v=l.ingredient)==null?void 0:v.id)||-1}})};await f.save(i),n.closeCreateReceiptDialog()},r=()=>{a.value=_(),u.value.splice(0,u.value.length)};return(i,l)=>(C(),x(ee,{"full-width":"","full-height":"",onBeforeHide:r},{default:o(()=>[t(I,null,{default:o(()=>[t(g,{class:"flex justify-between"},{default:o(()=>[Ke,e("div",We,[t(S,{label:"\uB4F1\uB85D",color:"primary",onClick:A}),te(t(S,{label:"\uB2EB\uAE30"},null,512),[[le]])])]),_:1}),t(g,{class:"row"},{default:o(()=>[e("div",Xe,[t(ae,{onOnIngredientClick:c}),t(oe,{onOnSecretBaseClick:p})]),e("div",Ye,[t(I,{class:"q-gutter-y-sm",width:"30vw"},{default:o(()=>[e("div",Ze,[e("div",et,[t(J,{modelValue:a.value.category,"onUpdate:modelValue":l[0]||(l[0]=s=>a.value.category=s),options:h(V),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",tt,[t(y,{modelValue:a.value.name,"onUpdate:modelValue":l[1]||(l[1]=s=>a.value.name=s),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e("div",lt,[t(y,{modelValue:a.value.sellingPrice,"onUpdate:modelValue":l[2]||(l[2]=s=>a.value.sellingPrice=s),type:"number",label:"\uD76C\uB9DD \uD310\uB9E4\uAC00(\uC6D0)","stack-label":"",outlined:""},null,8,["modelValue"])])]),t(se,{amount:D.value.amount,"unit-price":D.value.unitPrice},null,8,["amount","unit-price"]),u.value.length>0?(C(),x(g,{key:0},{default:o(()=>[at,t(T,null,{default:o(()=>[(C(!0),B(R,null,w(u.value,(s,v)=>(C(),x(j,{key:v},{default:o(()=>[t(G,null,{default:o(()=>{var P,q;return[t(y,{type:"number",modelValue:s.amount,"onUpdate:modelValue":U=>s.amount=U,label:((P=s.ingredient)==null?void 0:P.name)||((q=s.secretBase)==null?void 0:q.name)||"","stack-label":"",outlined:""},{default:o(()=>[t(z,{name:"close",size:"12px",onClick:U=>d(s)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):O("",!0),t(g,null,{default:o(()=>[t(X,K(W(D.value)),null,16)]),_:1}),t(g,null,{default:o(()=>[t(y,{modelValue:a.value.memo,"onUpdate:modelValue":l[3]||(l[3]=s=>a.value.memo=s),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),ot=e("div",{class:"text-h6"},"\uB808\uC2DC\uD53C \uC218\uC815",-1),ut={class:"q-gutter-x-md"},nt={class:"col-8 q-gutter-y-md"},it={class:"col-4 q-px-md"},ct={class:"row"},dt={class:"col-4 q-pr-md"},rt={class:"col-4 q-pr-md"},mt={class:"col-4"},pt=e("div",{class:"text-subtitle2 q-mb-sm"}," \uC6D0\uC7AC\uB8CC ",-1),Ct=Q({__name:"UpdateReceiptDialog",setup(b){const n=H();let f=L();const a=$((()=>({name:"",memo:"",category:V[0],sellingPrice:0}))()),u=$([]),c=i=>{const l={type:"INGREDIENT",amount:10,ingredient:i};u.value.some(v=>E(v,l))||u.value.push(l)},p=i=>{const l={type:"SECRET_BASE",amount:10,secretBase:i};u.value.some(v=>E(v,l))||u.value.push(l)},d=async()=>{const i={name:a.value.name,memo:a.value.memo,category:a.value.category.value,sellingPrice:a.value.sellingPrice,components:u.value.map(l=>{var s,v;return{type:l.type,amount:l.amount,id:((s=l.secretBase)==null?void 0:s.id)||((v=l.ingredient)==null?void 0:v.id)||-1}})};await f.update(n.updateReceipt.id,i),n.closeUpdateReceiptDialog()},D=i=>{const l=u.value.findIndex(s=>E(s,i));l!==-1&&u.value.splice(l,1)},A=k(()=>{const i=new M;return i.addReceiptComponents(u.value),i}),r=()=>{a.value.name=n.updateReceipt.name,a.value.memo=n.updateReceipt.memo||"",a.value.category=V.find(i=>i.value===n.updateReceipt.category),a.value.sellingPrice=n.updateReceipt.sellingPrice,u.value=n.updateReceipt.components};return(i,l)=>(C(),x(ee,{"full-width":"","full-height":"",onBeforeShow:r},{default:o(()=>[t(I,null,{default:o(()=>[t(g,{class:"flex justify-between"},{default:o(()=>[ot,e("div",ut,[t(S,{label:"\uC218\uC815",color:"primary",onClick:d}),te(t(S,{label:"\uB2EB\uAE30"},null,512),[[le]])])]),_:1}),t(g,{class:"row"},{default:o(()=>[e("div",nt,[t(ae,{onOnIngredientClick:c}),t(oe,{onOnSecretBaseClick:p})]),e("div",it,[t(I,{class:"q-gutter-y-sm",width:"30vw"},{default:o(()=>[e("div",ct,[e("div",dt,[t(J,{modelValue:a.value.category,"onUpdate:modelValue":l[0]||(l[0]=s=>a.value.category=s),options:h(V),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",rt,[t(y,{modelValue:a.value.name,"onUpdate:modelValue":l[1]||(l[1]=s=>a.value.name=s),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e("div",mt,[t(y,{modelValue:a.value.sellingPrice,"onUpdate:modelValue":l[2]||(l[2]=s=>a.value.sellingPrice=s),type:"number",label:"\uD76C\uB9DD \uD310\uB9E4\uAC00(\uC6D0)","stack-label":"",outlined:""},null,8,["modelValue"])])]),t(se,{amount:A.value.amount,"unit-price":A.value.unitPrice},null,8,["amount","unit-price"]),u.value.length>0?(C(),x(g,{key:0},{default:o(()=>[pt,t(T,null,{default:o(()=>[(C(!0),B(R,null,w(u.value,(s,v)=>(C(),x(j,{key:v},{default:o(()=>[t(G,null,{default:o(()=>{var P,q;return[t(y,{type:"number",modelValue:s.amount,"onUpdate:modelValue":U=>s.amount=U,label:((P=s.ingredient)==null?void 0:P.name)||((q=s.secretBase)==null?void 0:q.name)||"","stack-label":"",outlined:""},{default:o(()=>[t(z,{name:"close",size:"12px",onClick:U=>D(s)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):O("",!0),t(g,null,{default:o(()=>[t(X,K(W(A.value)),null,16)]),_:1}),t(g,null,{default:o(()=>[t(y,{modelValue:a.value.memo,"onUpdate:modelValue":l[3]||(l[3]=s=>a.value.memo=s),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),_t=e("div",{class:"flex full-width q-mb-md"},[e("span",{class:"text-h4 text-bold"},"\uB808\uC2DC\uD53C")],-1),vt={class:"row full-width"},gt={class:"col-3 q-px-md"},ft={class:"col-9"},ht={class:"flex justify-end q-px-lg q-gutter-lg"},xt={class:"q-gutter-md flex full-width"},Bt=Q({__name:"receipts",setup(b){const n=H(),f=L(),_=$(""),a=$([]),u=k(()=>{let c=f.receipts;return a.value.length>0&&(c=c.filter(p=>a.value.some(d=>p.category===d.value))),_.value&&(c=c.filter(p=>p.name.includes(_.value))),c});return ie(async()=>{await f.refresh()}),(c,p)=>(C(),x(de,{class:"full-width q-pa-xl"},{default:o(()=>[_t,e("div",vt,[e("div",gt,[t(J,{modelValue:a.value,"onUpdate:modelValue":p[0]||(p[0]=d=>a.value=d),multiple:"",options:h(V),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",ft,[e("div",ht,[t(y,{modelValue:_.value,"onUpdate:modelValue":p[1]||(p[1]=d=>_.value=d),type:"text",label:"\uC7AC\uB8CC \uCC3E\uAE30(\uC7AC\uB8CC\uBA85)",style:{width:"300px"},"stack-label":"",dense:""},{append:o(()=>[t(z,{name:"search"})]),_:1},8,["modelValue"]),t(S,{color:"primary",label:"\uB808\uC2DC\uD53C \uB4F1\uB85D\uD558\uAE30",onClick:h(n).showCreateReceiptDialog},null,8,["onClick"])])])]),t(Z,{class:"q-my-md full-width"}),e("div",xt,[(C(!0),B(R,null,w(u.value,(d,D)=>(C(),x(we,{key:D,id:d.id,name:d.name,memo:d.memo,category:d.category,"selling-price":d.sellingPrice,components:d.components,"created-at":d.createdAt,"updated-at":d.updatedAt},null,8,["id","name","memo","category","selling-price","components","created-at","updated-at"]))),128))]),t(st,{modelValue:h(n).createReceiptDialog,"onUpdate:modelValue":p[2]||(p[2]=d=>h(n).createReceiptDialog=d)},null,8,["modelValue"]),t(Ct,{modelValue:h(n).updateReceiptDialog,"onUpdate:modelValue":p[3]||(p[3]=d=>h(n).updateReceiptDialog=d)},null,8,["modelValue"])]),_:1}))}});typeof Y=="function"&&Y(Bt);export{Bt as default};
