import{C as ee,D as v,d as V,a as w,c as $,o as C,e as f,w as t,_ as P,aH as E,g as e,f as s,t as k,E as S,n as x,h as p,Q as J,i as F,p as I,r as q,F as U,G as N,H as j,k as H,l as L,m as O,I as K,j as W,aI as X,J as Y,M as z,K as T,L as te,N as ae}from"./index.d24fbe54.js";import{Q as le,_ as R,a as g}from"./ingredient.ed0b9d9d.js";import{a as A,Q as ne,b as G}from"./route-block.50262eb6.js";import{a as M,_ as Z}from"./AmountUnitPriceCaption.7d375513.js";const Q=ee("secretBasePageStore",()=>{const B=v(!1),i=()=>{B.value=!0},o=()=>{B.value=!1},l=v({components:[],createdAt:"",id:0,memo:"",name:"",updatedAt:""}),u=v(!1);return{createSecretBaseDialog:B,showCreateSecretBaseDialog:i,closeCreateSecretBaseDialog:o,updateSecretBase:l,updateSecretBaseDialog:u,showUpdateSecretBaseDialog:r=>{l.value=r,u.value=!0},closeUpdateSecretBaseDialog:()=>{u.value=!1}}}),ue={class:"text-h5"},se={class:"q-gutter-md"},oe=s("div",{class:"text-subtitle2 q-mb-sm"},"\uC6D0\uC7AC\uB8CC",-1),de=s("div",{class:"text-caption"},"\uBA54\uBAA8",-1),ce={style:{"min-height":"60px"}},re=V({__name:"SecretBaseCard",props:{id:{},name:{},memo:{},components:{},createdAt:{},updatedAt:{}},setup(B){const i=B,o=Q(),l=w(),u=$(()=>{let m=new E;return i&&m.addSecretBaseComponents(i.components),m}),c=m=>{confirm("\uC815\uB9D0 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC5B4\uC694?")&&l.remove(m)};return(m,r)=>(C(),f(P,{style:{width:"400px"}},{default:t(()=>[e(p,{class:"flex"},{default:t(()=>[s("div",null,[s("div",ue,k(i.name),1),e(M,{amount:u.value.amount,"unit-price":u.value.unitPrice},null,8,["amount","unit-price"])]),e(le),s("div",se,[e(S,{dense:"",outline:"",color:"secondary",onClick:r[0]||(r[0]=_=>x(o).showUpdateSecretBaseDialog(i)),icon:"edit",flat:""}),e(S,{dense:"",outline:"",color:"red",onClick:r[1]||(r[1]=_=>c(i.id)),icon:"delete",flat:""})])]),_:1}),e(J),e(p,null,{default:t(()=>[oe,e(F,{bordered:""},{default:t(()=>[(C(!0),I(U,null,q(i==null?void 0:i.components,(_,h)=>(C(),f(H,{class:"q-my-sm",key:h},{default:t(()=>[e(L,null,{default:t(()=>[e(A,null,{default:t(()=>[O(k(_.amount),1)]),_:2},1024),e(A,{caption:"",lines:"1"},{default:t(()=>[O(k(_.ingredient.name)+"(g)",1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),e(p,null,{default:t(()=>[e(R,N(j(u.value)),null,16)]),_:1}),e(p,null,{default:t(()=>[de,s("div",ce,k(i.memo),1)]),_:1})]),_:1}))}}),ie=s("div",{class:"text-h6"},"\uC2DC\uD06C\uB9BF \uBCA0\uC774\uC2A4 \uB4F1\uB85D",-1),me={class:"q-gutter-x-md"},pe={class:"col-4 q-px-md"},Ce={class:"text-subtitle1"},_e=s("div",{class:"text-subtitle2 q-mb-sm"}," \uC6D0\uC7AC\uB8CC ",-1),fe=V({__name:"CreateSecretBaseDialog",setup(B){const i=w(),o=Q(),l=v(""),u=v(""),c=v([]),m=n=>{c.value.some(a=>a.ingredient.name===n.name)||c.value.push({amount:10,ingredient:n})},r=n=>{const d=c.value.findIndex(a=>a.ingredient.name===n.ingredient.name);d!==-1&&c.value.splice(d,1)},_=$(()=>{const n=new E;return n.addSecretBaseComponents(c.value),n}),h=async()=>{const n={name:l.value,memo:u.value,components:c.value.map(d=>({amount:d.amount,ingredientId:d.ingredient.id}))};await i.save(n),c.value.splice(0,c.value.length),o.closeCreateSecretBaseDialog()},D=()=>{for(l.value="",u.value="";c.value.pop(););};return(n,d)=>(C(),f(K,{"full-width":"","full-height":"",onBeforeHide:D},{default:t(()=>[e(P,null,{default:t(()=>[e(p,{class:"flex justify-between"},{default:t(()=>[ie,s("div",me,[e(S,{label:"\uB4F1\uB85D",color:"primary",onClick:h}),W(e(S,{label:"\uB2EB\uAE30"},null,512),[[Y]])])]),_:1}),e(p,{class:"row"},{default:t(()=>[e(Z,{class:"col-8",onOnIngredientClick:m}),s("div",pe,[e(P,{class:"q-gutter-y-sm",width:"30vw"},{default:t(()=>[s("div",Ce,[e(g,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=a=>l.value=a),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e(M,{amount:_.value.amount,"unit-price":_.value.unitPrice},null,8,["amount","unit-price"]),c.value.length>0?(C(),f(p,{key:0},{default:t(()=>[_e,e(F,null,{default:t(()=>[(C(!0),I(U,null,q(c.value,a=>(C(),f(H,{key:a.ingredient.name},{default:t(()=>[e(L,null,{default:t(()=>[e(g,{type:"number",modelValue:a.amount,"onUpdate:modelValue":b=>a.amount=b,label:a.ingredient.name,"stack-label":"",outlined:""},{append:t(()=>[e(A,null,{default:t(()=>[e(z,{name:"close",size:"12px",class:"cursor-pointer",onClick:b=>r(a)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):X("",!0),e(p,null,{default:t(()=>[e(R,N(j(_.value)),null,16)]),_:1}),e(p,null,{default:t(()=>[e(g,{modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=a=>u.value=a),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),ve=s("div",{class:"text-h6"},"\uC2DC\uD06C\uB9BF \uBCA0\uC774\uC2A4 \uC218\uC815",-1),Be={class:"q-gutter-x-md"},ge={class:"col-4 q-px-md"},Se={class:"text-subtitle1"},xe=s("div",{class:"text-subtitle2 q-mb-sm"}," \uC6D0\uC7AC\uB8CC ",-1),he=V({__name:"UpdateSecretBaseDialog",setup(B){let i=w();const o=Q(),l=v({name:"",memo:""}),u=v([]),c=()=>{l.value.name=o.updateSecretBase.name,l.value.memo=o.updateSecretBase.memo||"",console.log(o.updateSecretBase),o.updateSecretBase.components.forEach(n=>{u.value.push({amount:n.amount,ingredient:n.ingredient})})},m=()=>{l.value.name="",l.value.memo="",u.value=[]},r=async()=>{o.updateSecretBase.name=l.value.name,o.updateSecretBase.memo=l.value.memo,await i.update(o.updateSecretBase.id,{name:l.value.name,memo:l.value.memo,components:u.value.map(n=>({amount:n.amount,ingredientId:n.ingredient.id}))}),o.closeUpdateSecretBaseDialog()},_=n=>{u.value.some(a=>a.ingredient.name===n.name)||u.value.push({amount:10,ingredient:n})},h=n=>{const d=u.value.findIndex(a=>a.ingredient.name===n.ingredient.name);d!==-1&&u.value.splice(d,1)},D=$(()=>{let n=new E;return n.addSecretBaseComponents(u.value),console.log("totalIngredients",n),n});return(n,d)=>(C(),f(K,{"full-width":"","full-height":"",onBeforeShow:c,onBeforeHide:m},{default:t(()=>[e(T,{class:"q-pa-sm"},{default:t(()=>[e(p,{class:"flex justify-between"},{default:t(()=>[ve,s("div",Be,[e(S,{label:"\uC218\uC815",color:"primary",onClick:r}),W(e(S,{label:"\uB2EB\uAE30"},null,512),[[Y]])])]),_:1}),e(p,{class:"row"},{default:t(()=>[e(Z,{class:"col-8",onOnIngredientClick:_}),s("div",ge,[e(T,{class:"q-pa-md q-gutter-y-sm"},{default:t(()=>[s("div",Se,[e(g,{modelValue:l.value.name,"onUpdate:modelValue":d[0]||(d[0]=a=>l.value.name=a),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e(M,{amount:D.value.amount,"unit-price":D.value.unitPrice},null,8,["amount","unit-price"]),u.value.length>0?(C(),f(p,{key:0},{default:t(()=>[xe,e(F,null,{default:t(()=>[(C(!0),I(U,null,q(u.value,(a,b)=>(C(),f(H,{key:b},{default:t(()=>[e(L,null,{default:t(()=>[e(g,{modelValue:a.amount,"onUpdate:modelValue":y=>a.amount=y,type:"number",label:a.ingredient.name,onInput:y=>a.amount=Number(y),"stack-label":"",outlined:""},{append:t(()=>[e(A,null,{default:t(()=>[e(z,{name:"close",size:"12px",class:"cursor-pointer",onClick:y=>h(a)},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["modelValue","onUpdate:modelValue","label","onInput"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):X("",!0),e(p,null,{default:t(()=>[e(R,N(j(D.value)),null,16)]),_:1}),e(p,null,{default:t(()=>[e(g,{modelValue:l.value.memo,"onUpdate:modelValue":d[1]||(d[1]=a=>l.value.memo=a),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),De=s("div",{class:"flex full-width q-mb-md"},[s("span",{class:"text-h4 text-bold"},"\uC2DC\uD06C\uB9BF \uBCA0\uC774\uC2A4")],-1),be={class:"row full-width"},ye=s("div",{class:"col-6"},null,-1),ke={class:"col-6"},Ae={class:"flex justify-end q-px-lg q-gutter-lg"},Ve={class:"q-gutter-md flex full-width"},we=V({__name:"secret-bases",setup(B){const i=w(),o=Q(),l=v(""),u=$(()=>i.secretBases.filter(c=>c.name.includes(l.value)));return te(async()=>{await i.fetchAll()}),(c,m)=>(C(),f(ne,{class:"full-width q-pa-xl"},{default:t(()=>[De,s("div",be,[ye,s("div",ke,[s("div",Ae,[e(g,{modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=r=>l.value=r),dense:"",type:"text",label:"\uC7AC\uB8CC \uCC3E\uAE30(\uC7AC\uB8CC\uBA85)",style:{width:"300px"},"stack-label":""},{append:t(()=>[e(z,{name:"search"})]),_:1},8,["modelValue"]),e(S,{color:"primary",label:"\uC2DC\uD06C\uB9BF \uBCA0\uC774\uC2A4 \uB4F1\uB85D\uD558\uAE30",onClick:x(o).showCreateSecretBaseDialog},null,8,["onClick"])])])]),e(J,{class:"q-my-md full-width"}),s("div",Ve,[(C(!0),I(U,null,q(u.value,r=>(C(),f(re,ae({key:r.name},r),null,16))),128))]),e(fe,{modelValue:x(o).createSecretBaseDialog,"onUpdate:modelValue":m[1]||(m[1]=r=>x(o).createSecretBaseDialog=r)},null,8,["modelValue"]),e(he,{modelValue:x(o).updateSecretBaseDialog,"onUpdate:modelValue":m[2]||(m[2]=r=>x(o).updateSecretBaseDialog=r)},null,8,["modelValue"])]),_:1}))}});typeof G=="function"&&G(we);export{we as default};
