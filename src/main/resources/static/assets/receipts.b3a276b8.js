import{Q as J}from"./QSelect.08395f53.js";import{C as ue,D as b,d as I,b as L,c as B,o as C,e as h,w as n,_ as F,aH as M,g as t,f as e,t as m,n as x,E as $,h as v,Q as Z,p as y,i as T,F as E,r as R,aI as O,G as K,H as W,k as j,l as G,m as Q,a as ne,M as z,I as ee,j as te,J as le,L as ie}from"./index.6cf65dea.js";import{Q as ce,_ as X,a as D}from"./ingredient.43c4df62.js";import{a as N,Q as de,b as Y}from"./route-block.99de925c.js";import{R as re,l as me,r as S,i as V}from"./receipt.1056e981.js";import{Q as pe,_ as ae,a as se}from"./AmountUnitPriceCaption.e33897a0.js";const H=ue("receiptPageStore",()=>{const k=b(!1),i=()=>{k.value=!0},g=()=>{k.value=!1},_=b({id:0,memo:"",name:"",sellingPrice:0,category:re.coffee,components:[],createdAt:"",updatedAt:""}),o=b(!1);return{createReceiptDialog:k,showCreateReceiptDialog:i,closeCreateReceiptDialog:g,updateReceipt:_,updateReceiptDialog:o,showUpdateReceiptDialog:d=>{_.value=d,o.value=!0},closeUpdateReceiptDialog:()=>{o.value=!1}}}),Ce={class:"text-h5"},_e={class:"flex q-gutter-x-md"},ve={class:"text-subtitle2"},ge={class:"text-subtitle2"},fe={class:"flex q-gutter-x-md"},he={class:"text-caption"},Be={class:"text-caption"},xe={class:"text-caption"},ye={class:"text-caption"},De={class:"text-caption"},be={class:"q-gutter-sm"},ke={class:"row"},Ae={key:0,class:"col-6"},$e=e("div",{class:"text-subtitle2 q-mb-sm"},"\uBCA0\uC774\uC2A4",-1),Se={key:1,class:"col-6"},Ve=e("div",{class:"text-subtitle2 q-mb-sm"},"\uC6D0\uC7AC\uB8CC",-1),Ee=e("div",{class:"text-caption"},"\uBA54\uBAA8",-1),Re={style:{"min-height":"60px"}},we=I({__name:"ReceiptCard",props:{id:{},name:{},memo:{},category:{},components:{},sellingPrice:{},createdAt:{},updatedAt:{}},setup(k){const i=k,g=H(),_=L(),o=B(()=>i.components.filter(s=>s.type==="SECRET_BASE")),u=B(()=>i.components.filter(s=>s.type==="INGREDIENT")),p=B(()=>{let s=new M;return s.addReceiptComponents(i.components),s}),d=B(()=>{let s=Number(i.sellingPrice);return!s||s===0?0:s*.1}),c=B(()=>{let s=Number(i.sellingPrice);return!s||s===0?0:s*.011}),f=B(()=>{let s=Number(i.sellingPrice);if(!s||s===0)return 0;const l=p.value.getUnitPrice();return(s-(Number(l)+d.value+c.value))/s}),A=async s=>{confirm("\uC815\uB9D0 \uC0AD\uC81C \uD558\uC2DC\uACA0\uC5B4\uC694?")&&await _.remove(s)},w=async()=>{if(confirm(`[${i.name}] \uB808\uC2DC\uD53C\uB97C \uBCF5\uC0AC\uD569\uB2C8\uB2E4. \uACC4\uC18D \uD560\uAE4C\uC694?`)){const s={name:i.name,memo:i.memo,category:i.category,sellingPrice:i.sellingPrice,components:i.components.map(l=>{var a,r;return{type:l.type,amount:l.amount,id:((a=l.ingredient)==null?void 0:a.id)||((r=l.secretBase)==null?void 0:r.id)}})};await _.save(s)}};return(s,l)=>(C(),h(F,{style:{width:"400px"}},{default:n(()=>[t(v,{class:"flex"},{default:n(()=>[e("div",null,[e("div",Ce,m(i.name),1),e("div",_e,[e("div",ve,m(x(me)(i.category)),1),e("span",ge,"\uC911\uB7C9: "+m(Number(p.value.getAmount()).toFixed(0))+"g",1)]),e("div",fe,[e("div",he,"\uD310\uB9E4\uAC00: "+m(Number(i.sellingPrice).toFixed(0))+"\uC6D0",1),e("div",Be,"\uB2E8\uAC00: "+m(Number(p.value.getUnitPrice()).toFixed(0))+"\uC6D0",1),e("div",xe,"\uBD80\uAC00\uC138: "+m(d.value)+"\uC6D0",1),e("div",ye,"\uCE74\uB4DC\uC218\uC218\uB8CC: "+m(c.value)+"\uC6D0",1),e("div",De,"\uB9C8\uC9C4\uC728: "+m((f.value*100).toFixed(2))+"%",1)])]),t(ce),e("div",be,[t($,{dense:"",outline:"",color:"yellow-9",onClick:w,icon:"file_copy",flat:""}),t($,{dense:"",outline:"",color:"secondary",onClick:l[0]||(l[0]=a=>x(g).showUpdateReceiptDialog(i)),icon:"edit",flat:""}),t($,{dense:"",outline:"",color:"red",icon:"delete",flat:"",onClick:l[1]||(l[1]=a=>A(i.id))})])]),_:1}),t(Z),t(v,null,{default:n(()=>[e("div",ke,[o.value.length>0?(C(),y("div",Ae,[$e,t(T,{bordered:""},{default:n(()=>[(C(!0),y(E,null,R(o.value,(a,r)=>(C(),h(j,{key:r},{default:n(()=>[t(G,null,{default:n(()=>[t(N,null,{default:n(()=>[Q(m(a.amount),1)]),_:2},1024),t(N,{caption:"",lines:"1"},{default:n(()=>[Q(m(a.secretBase.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):O("",!0),u.value.length>0?(C(),y("div",Se,[Ve,t(T,{bordered:""},{default:n(()=>[(C(!0),y(E,null,R(u.value,(a,r)=>(C(),h(j,{key:r},{default:n(()=>[t(G,null,{default:n(()=>[t(N,null,{default:n(()=>[Q(m(a.amount),1)]),_:2},1024),t(N,{caption:"",lines:"1"},{default:n(()=>[Q(m(a.ingredient.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})])):O("",!0)])]),_:1}),t(v,null,{default:n(()=>[t(X,K(W(p.value)),null,16)]),_:1}),t(v,null,{default:n(()=>[Ee,e("div",Re,m(i.memo),1)]),_:1})]),_:1}))}}),Pe={class:"q-px-md"},qe={class:"row justify-end q-mb-lg"},Ue={class:"col-3"},Fe=e("thead",null,[e("tr",null,[e("th",{class:"text-center"},"\uC6D0\uC7AC\uB8CC\uBA85"),e("th",{class:"text-center"},"\uCE7C\uB85C\uB9AC(Kcal)"),e("th",{class:"text-center"},"\uD0C4\uC218\uD654\uBB3C(g)"),e("th",{class:"text-center"},"\uB2F9\uB958(g)"),e("th",{class:"text-center"},"\uC2DD\uC774\uC12C\uC720(g)"),e("th",{class:"text-center"},"\uC9C0\uBC29(g)"),e("th",{class:"text-center"},"\uD3EC\uD654\uC9C0\uBC29(g)"),e("th",{class:"text-center"},"\uB2E8\uBC31\uC9C8(g)"),e("th",{class:"text-center"},"\uCE74\uD398\uC778(mg)"),e("th",{class:"text-center"},"\uC911\uB7C9(g)"),e("th",{class:"text-center"},"\uB2E8\uAC00(\uC6D0)")])],-1),Ie=["onClick"],Qe={class:"text-center"},Ne={class:"text-right"},Te={class:"text-right"},Oe={class:"text-right"},je={class:"text-right"},Ge={class:"text-right"},Le={class:"text-right"},Me={class:"text-right"},ze={class:"text-right"},He={class:"text-right"},Je={class:"text-right"},oe=I({__name:"SecretBaseSearchTable",emits:["onSecretBaseClick"],setup(k){const i=ne(),g=u=>{const p=new M(u.id,u.name);return p.addSecretBaseComponents(u.components),p},_=b(""),o=B(()=>_.value===""?i.secretBases.map(u=>({secretBase:u,summary:g(u)})):i.secretBases.filter(u=>u.name.includes(_.value)).map(u=>({secretBase:u,summary:g(u)})));return(u,p)=>(C(),y("div",Pe,[e("div",qe,[e("div",Ue,[t(D,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=d=>_.value=d),type:"text",label:"\uC2DC\uD06C\uB9BF\uBCA0\uC774\uC2A4 \uCC3E\uAE30","stack-label":""},{default:n(()=>[t(z,{name:"search",color:"secondary"})]),_:1},8,["modelValue"])])]),t(pe,null,{default:n(()=>[Fe,e("tbody",null,[(C(!0),y(E,null,R(o.value,({secretBase:d,summary:c},f)=>(C(),y("tr",{key:f,onClick:A=>u.$emit("onSecretBaseClick",d)},[e("td",Qe,m(c.getName()),1),e("td",Ne,m(c.getCalories()),1),e("td",Te,m(c.getCarbohydrates()),1),e("td",Oe,m(c.getSugar()),1),e("td",je,m(c.getFiber()),1),e("td",Ge,m(c.getFat()),1),e("td",Le,m(c.getSaturatedFat()),1),e("td",Me,m(c.getProtein()),1),e("td",ze,m(c.getCaffeine()),1),e("td",He,m(c.getAmount()),1),e("td",Je,m(c.getUnitPrice()),1)],8,Ie))),128))])]),_:1})]))}}),Ke=e("div",{class:"text-h6"},"\uB808\uC2DC\uD53C \uB4F1\uB85D",-1),We={class:"q-gutter-x-md"},Xe={class:"col-8 q-gutter-y-md"},Ye={class:"col-4 q-px-md"},Ze={class:"row"},et={class:"col-4 q-pr-md"},tt={class:"col-4 q-pr-md"},lt={class:"col-4"},at=e("div",{class:"text-subtitle2 q-mb-sm"}," \uC7AC\uB8CC ",-1),st=I({__name:"CreateReceiptDialog",setup(k){const i=H(),g=L(),_=()=>({name:"",memo:"",category:S[0],sellingPrice:0}),o=b(_()),u=b([]),p=s=>{const l={type:"INGREDIENT",amount:10,ingredient:s};u.value.some(r=>V(r,l))||u.value.push(l)},d=s=>{const l={type:"SECRET_BASE",amount:10,secretBase:s};u.value.some(r=>V(r,l))||u.value.push(l)},c=s=>{const l=u.value.findIndex(a=>V(a,s));l!==-1&&u.value.splice(l,1)},f=B(()=>{const s=new M;return s.addReceiptComponents(u.value),s}),A=async()=>{const s={name:o.value.name,memo:o.value.memo,category:o.value.category.value,sellingPrice:o.value.sellingPrice,components:u.value.map(l=>{var a,r;return{type:l.type,amount:l.amount,id:((a=l.secretBase)==null?void 0:a.id)||((r=l.ingredient)==null?void 0:r.id)||-1}})};await g.save(s),i.closeCreateReceiptDialog()},w=()=>{o.value=_(),u.value.splice(0,u.value.length)};return(s,l)=>(C(),h(ee,{"full-width":"","full-height":"",onBeforeHide:w},{default:n(()=>[t(F,null,{default:n(()=>[t(v,{class:"flex justify-between"},{default:n(()=>[Ke,e("div",We,[t($,{label:"\uB4F1\uB85D",color:"primary",onClick:A}),te(t($,{label:"\uB2EB\uAE30"},null,512),[[le]])])]),_:1}),t(v,{class:"row"},{default:n(()=>[e("div",Xe,[t(ae,{onOnIngredientClick:p}),t(oe,{onOnSecretBaseClick:d})]),e("div",Ye,[t(F,{class:"q-gutter-y-sm",width:"30vw"},{default:n(()=>[e("div",Ze,[e("div",et,[t(J,{modelValue:o.value.category,"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.category=a),options:x(S),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",tt,[t(D,{modelValue:o.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.name=a),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e("div",lt,[t(D,{modelValue:o.value.sellingPrice,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.sellingPrice=a),type:"number",label:"\uD76C\uB9DD \uD310\uB9E4\uAC00(\uC6D0)","stack-label":"",outlined:""},null,8,["modelValue"])])]),t(se,{amount:f.value.amount,"unit-price":f.value.unitPrice},null,8,["amount","unit-price"]),u.value.length>0?(C(),h(v,{key:0},{default:n(()=>[at,t(T,null,{default:n(()=>[(C(!0),y(E,null,R(u.value,(a,r)=>(C(),h(j,{key:r},{default:n(()=>[t(G,null,{default:n(()=>{var P,q;return[t(D,{type:"number",modelValue:a.amount,"onUpdate:modelValue":U=>a.amount=U,label:((P=a.ingredient)==null?void 0:P.name)||((q=a.secretBase)==null?void 0:q.name)||"","stack-label":"",outlined:""},{default:n(()=>[t(z,{name:"close",size:"12px",onClick:U=>c(a)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):O("",!0),t(v,null,{default:n(()=>[t(X,K(W(f.value)),null,16)]),_:1}),t(v,null,{default:n(()=>[t(D,{modelValue:o.value.memo,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.memo=a),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),ot=e("div",{class:"text-h6"},"\uB808\uC2DC\uD53C \uC218\uC815",-1),ut={class:"q-gutter-x-md"},nt={class:"col-8 q-gutter-y-md"},it={class:"col-4 q-px-md"},ct={class:"row"},dt={class:"col-4 q-pr-md"},rt={class:"col-4 q-pr-md"},mt={class:"col-4"},pt=e("div",{class:"text-subtitle2 q-mb-sm"}," \uC6D0\uC7AC\uB8CC ",-1),Ct=I({__name:"UpdateReceiptDialog",setup(k){const i=H();let g=L();const o=b((()=>({name:"",memo:"",category:S[0],sellingPrice:0}))()),u=b([]),p=s=>{const l={type:"INGREDIENT",amount:10,ingredient:s};u.value.some(r=>V(r,l))||u.value.push(l)},d=s=>{const l={type:"SECRET_BASE",amount:10,secretBase:s};u.value.some(r=>V(r,l))||u.value.push(l)},c=async()=>{const s={name:o.value.name,memo:o.value.memo,category:o.value.category.value,sellingPrice:o.value.sellingPrice,components:u.value.map(l=>{var a,r;return{type:l.type,amount:l.amount,id:((a=l.secretBase)==null?void 0:a.id)||((r=l.ingredient)==null?void 0:r.id)||-1}})};await g.update(i.updateReceipt.id,s),i.closeUpdateReceiptDialog()},f=s=>{const l=u.value.findIndex(a=>V(a,s));l!==-1&&u.value.splice(l,1)},A=B(()=>{const s=new M;return s.addReceiptComponents(u.value),s}),w=()=>{o.value.name=i.updateReceipt.name,o.value.memo=i.updateReceipt.memo||"",o.value.category=S.find(s=>s.value===i.updateReceipt.category),o.value.sellingPrice=i.updateReceipt.sellingPrice,u.value=i.updateReceipt.components};return(s,l)=>(C(),h(ee,{"full-width":"","full-height":"",onBeforeShow:w},{default:n(()=>[t(F,null,{default:n(()=>[t(v,{class:"flex justify-between"},{default:n(()=>[ot,e("div",ut,[t($,{label:"\uC218\uC815",color:"primary",onClick:c}),te(t($,{label:"\uB2EB\uAE30"},null,512),[[le]])])]),_:1}),t(v,{class:"row"},{default:n(()=>[e("div",nt,[t(ae,{onOnIngredientClick:p}),t(oe,{onOnSecretBaseClick:d})]),e("div",it,[t(F,{class:"q-gutter-y-sm",width:"30vw"},{default:n(()=>[e("div",ct,[e("div",dt,[t(J,{modelValue:o.value.category,"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.category=a),options:x(S),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",rt,[t(D,{modelValue:o.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.name=a),type:"text",label:"\uC774\uB984","stack-label":"",outlined:""},null,8,["modelValue"])]),e("div",mt,[t(D,{modelValue:o.value.sellingPrice,"onUpdate:modelValue":l[2]||(l[2]=a=>o.value.sellingPrice=a),type:"number",label:"\uD76C\uB9DD \uD310\uB9E4\uAC00(\uC6D0)","stack-label":"",outlined:""},null,8,["modelValue"])])]),t(se,{amount:A.value.amount,"unit-price":A.value.unitPrice},null,8,["amount","unit-price"]),u.value.length>0?(C(),h(v,{key:0},{default:n(()=>[pt,t(T,null,{default:n(()=>[(C(!0),y(E,null,R(u.value,(a,r)=>(C(),h(j,{key:r},{default:n(()=>[t(G,null,{default:n(()=>{var P,q;return[t(D,{type:"number",modelValue:a.amount,"onUpdate:modelValue":U=>a.amount=U,label:((P=a.ingredient)==null?void 0:P.name)||((q=a.secretBase)==null?void 0:q.name)||"","stack-label":"",outlined:""},{default:n(()=>[t(z,{name:"close",size:"12px",onClick:U=>f(a)},null,8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]}),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):O("",!0),t(v,null,{default:n(()=>[t(X,K(W(A.value)),null,16)]),_:1}),t(v,null,{default:n(()=>[t(D,{modelValue:o.value.memo,"onUpdate:modelValue":l[3]||(l[3]=a=>o.value.memo=a),type:"textarea",label:"\uBA54\uBAA8",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1}))}}),_t=e("div",{class:"flex full-width q-mb-md"},[e("span",{class:"text-h4 text-bold"},"\uB808\uC2DC\uD53C")],-1),vt={class:"row full-width"},gt={class:"col-3 q-px-md"},ft={class:"col-9"},ht={class:"flex justify-end q-px-lg q-gutter-lg"},Bt={class:"q-gutter-md flex full-width"},xt=I({__name:"receipts",setup(k){const i=H(),g=L(),_=b(""),o=b([]),u=B(()=>{let p=g.receipts;return o.value.length>0&&(p=p.filter(d=>o.value.some(c=>d.category===c.value))),_.value&&(p=p.filter(d=>d.name.includes(_.value))),p});return ie(async()=>{await g.refresh()}),(p,d)=>(C(),h(de,{class:"full-width q-pa-xl"},{default:n(()=>[_t,e("div",vt,[e("div",gt,[t(J,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=c=>o.value=c),multiple:"",options:x(S),label:"\uCE74\uD14C\uACE0\uB9AC","stack-label":"",outlined:""},null,8,["modelValue","options"])]),e("div",ft,[e("div",ht,[t(D,{modelValue:_.value,"onUpdate:modelValue":d[1]||(d[1]=c=>_.value=c),type:"text",label:"\uC7AC\uB8CC \uCC3E\uAE30(\uC7AC\uB8CC\uBA85)",style:{width:"300px"},"stack-label":"",dense:""},{append:n(()=>[t(z,{name:"search"})]),_:1},8,["modelValue"]),t($,{color:"primary",label:"\uB808\uC2DC\uD53C \uB4F1\uB85D\uD558\uAE30",onClick:x(i).showCreateReceiptDialog},null,8,["onClick"])])])]),t(Z,{class:"q-my-md full-width"}),e("div",Bt,[(C(!0),y(E,null,R(u.value,(c,f)=>(C(),h(we,{key:f,id:c.id,name:c.name,memo:c.memo,category:c.category,"selling-price":c.sellingPrice,components:c.components,"created-at":c.createdAt,"updated-at":c.updatedAt},null,8,["id","name","memo","category","selling-price","components","created-at","updated-at"]))),128))]),t(st,{modelValue:x(i).createReceiptDialog,"onUpdate:modelValue":d[2]||(d[2]=c=>x(i).createReceiptDialog=c)},null,8,["modelValue"]),t(Ct,{modelValue:x(i).updateReceiptDialog,"onUpdate:modelValue":d[3]||(d[3]=c=>x(i).updateReceiptDialog=c)},null,8,["modelValue"])]),_:1}))}});typeof Y=="function"&&Y(xt);export{xt as default};
